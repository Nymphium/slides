\section{Coroutines}
\begin{frame}
  \frametitlesec

  \begin{center}
    \begin{minipage}[c]{1.8em}
      e.g.)
    \end{minipage}
    \begin{minipage}[c]{.8\textwidth}
      \begin{itemize}
        \item[\hlinkclip{https://github.com/ocaml-multicore/ocaml-multicore}] \alert{Multicore OCaml}, implemented\\with \structure{fiber}, in \structure{C}~\cite{dolan2015effective} 
        \item[\hlinkclip{https://github.com/Nymphium/eff.lua}] \alert{eff.lua} , implemented with \structure{coroutine}, in \structure{Lua}
      \end{itemize}
    \end{minipage}
  \end{center}

  \pause

  \begin{table}[ht]
    \centering

    \setbeamercovered{transparent}

    \begin{tabular}{rcl}
      \alert{Algebraic Effects} & $\mapsto$ & \structure{Coroutines}\\\hline
      effect invocation & $\mapsto$ & yield\\
      effect handler & $\mapsto$ & create \& resume\\
      continuation & $\mapsto$ & coroutine
    \end{tabular}
  \end{table}
\end{frame}

\begin{frame}
  \frametitlesec

  \begin{table}[ht]
    \centering

    \setbeamercovered{transparent}

    \begin{tabular}{rcl}
      \uncover<1>{\alert{Algebraic Effects} & $\mapsto$ & \structure{Coroutines}\\\hline}
      \uncover<1>{effect invocation & $\mapsto$ & yield}\\
      \uncover<1>{effect handler & $\mapsto$ & create \& resume}\\
      \uncover<1->{\tikz\coordinate[remember picture] (continuation);\null continuation & $\mapsto$ & coroutine\tikz\coordinate[remember picture] (coroutine);\null }
    \end{tabular}
  \end{table}

  \begin{onlyenv}<3->
    \begin{tikzpicture}[overlay]
      \node[
        draw,
        rectangle callout,
        fill=cream,
        above = of continuation,
        xshift=.5\zw,
        callout absolute pointer={($(continuation) + (1, .4) $)}]
        {ä½•å›ã‚‚å‘¼ã³å‡ºã—ãŸã„ã‘ã©};
      \node[
        draw,
        rectangle callout,
        fill=cream,
        above=of coroutine,
        callout absolute pointer={($(coroutine) - (1, -.4)$)}
        ]
        {çŠ¶æ…‹ã‚’ã‚³ãƒ”ãƒ¼ã§ããªã„};
    \end{tikzpicture}
  \end{onlyenv}

  \onslide<4->{
    \centering
    \begin{minipage}{1em}
      \Large \coloremoji{âš }%
    \end{minipage}
    \begin{minipage}{.9\textwidth}
      \centering coroutinesã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹ã‚ˆã†ãªæ“ä½œãŒãªã‘ã‚Œã°\\
      ç¶™ç¶šã¯\alert{ãƒ¯ãƒ³ã‚·ãƒ§ãƒƒãƒˆã«é™å®š}ã•ã‚Œã‚‹
    \end{minipage}
  }
\end{frame}

\subsection*{pros/cons}
\begin{frame}[fragile]
  \frametitlesubs

  \pause
  \begin{itemize}
    \item<+->[\coloremoji{ğŸ˜}] \itemheader{ã•ã¾ã–ã¾ãªè¨€èªã§å®Ÿè£…å¯èƒ½}

      Coroutinesã‚’æŒã£ã¦ã‚‹è¨€èªã¯å¤šã„\coloremoji{ğŸ˜‰}

      {\small Lua, Ruby, JS, Kotlin, Python, etc.}

    \item<+->[\coloremoji{ğŸ˜…}] \itemheader{ç¶™ç¶šã¯ãƒ¯ãƒ³ã‚·ãƒ§ãƒƒãƒˆ}

      éæ±ºå®šè¨ˆç®—ã¨ã‹ã¯æ›¸ã‘ãªã„

    \item<+->[\coloremoji{ğŸ¤”}] \itemheader{coroutineã‚’è¤‡è£½ã™ã‚‹æ“ä½œãŒã‚ã‚Œã°â€¦â€¦}

      \alert{Multicore OCaml}ã®\lstinline{Obj.clone_continuation}ã®å®Ÿè£…
  \end{itemize}
\end{frame}
